import{a6 as j,a7 as q,a8 as Z,a9 as d,aa as U,ab as ee,ac as te,ad as se,ae as K,af as ae,S as oe,h as F,r as f,O as P,o as G,v,Q as B,J as g,m,l as L,y as z,ag as ne,x as A,F as J,I as Q,p,R as D,ah as re,ai as le,aj as ce,ak as ie,K as h,B as Y,q as ue,t as de,N as C,w as R,n as ve,al as ge}from"./index-7gtwGELg.js";import"//at.alicdn.com/t/c/font_4565805_mtkshfnyzag.js";const k=(a,e)=>new j(a).setAlpha(e).toRgbString(),I=(a,e)=>new j(a).lighten(e).toHexString(),fe=a=>{const e=q(a,{theme:"dark"});return{1:e[0],2:e[1],3:e[2],4:e[3],5:e[6],6:e[5],7:e[4],8:e[6],9:e[5],10:e[4]}},pe=(a,e)=>{const s=a||"#000",t=e||"#fff";return{colorBgBase:s,colorTextBase:t,colorText:k(t,.85),colorTextSecondary:k(t,.65),colorTextTertiary:k(t,.45),colorTextQuaternary:k(t,.25),colorFill:k(t,.18),colorFillSecondary:k(t,.12),colorFillTertiary:k(t,.08),colorFillQuaternary:k(t,.04),colorBgElevated:I(s,12),colorBgContainer:I(s,8),colorBgLayout:I(s,0),colorBgSpotlight:I(s,26),colorBorder:I(s,26),colorBorderSecondary:I(s,19)}},_e=(a,e)=>{const s=Object.keys(Z).map(n=>{const l=q(a[n],{theme:"dark"});return new Array(10).fill(1).reduce((y,T,S)=>(y[`${n}-${S+1}`]=l[S],y),{})}).reduce((n,l)=>(n=d(d({},n),l),n),{}),t=e??U(a);return d(d(d({},t),s),ee(a,{generateColorPalettes:fe,generateNeutralColorPalettes:pe}))};function he(a){const{sizeUnit:e,sizeStep:s}=a,t=s-2;return{sizeXXL:e*(t+10),sizeXL:e*(t+6),sizeLG:e*(t+2),sizeMD:e*(t+2),sizeMS:e*(t+1),size:e*t,sizeSM:e*t,sizeXS:e*(t-1),sizeXXS:e*(t-1)}}const me=(a,e)=>{const s=e??U(a),t=s.fontSizeSM,n=s.controlHeight-4;return d(d(d(d(d({},s),he(e??a)),te(t)),{controlHeight:n}),se(d(d({},s),{controlHeight:n})))};function ye(){const[a,e,s]=ae();return{theme:a,token:e,hashId:s}}const ke={defaultConfig:K,defaultSeed:K.token,useToken:ye,defaultAlgorithm:U,darkAlgorithm:_e,compactAlgorithm:me},Se=oe,xe=Se+"/api/v1";async function Ce(a,e,s,t=null,n=null){a=xe+a,t&&(a+="?"+new URLSearchParams(t).toString());try{return(await fetch(a,{method:e,headers:s,body:n?JSON.stringify(n):void 0})).json()}catch(l){console.error("Error:",l)}}async function W(a,e,s=null,t=null){return Ce(a,e,{"Content-Type":"application/json"},s,t)}const Te={class:"header-content"},we={class:"value-display"},Me={key:1,class:"stored-value"},$e={class:"button-container"},H="SJ_API_KEY",be=F({__name:"HeaderComponent",setup(a){const e=f(""),s=f(""),t=f(!1),n=f(!1),l=P(()=>{const r=e.value;return r.length<=4?r:r.length<=8?r.slice(0,4)+"*".repeat(r.length-4):r.slice(0,4)+"****..."}),y=P(()=>e.value?"重置秘钥":"输入秘钥"),T=()=>{const r=localStorage.getItem(H);r?(e.value=r,i()):S()},S=()=>{t.value=!0},u=()=>{t.value=!1,s.value=""},c=()=>{s.value.trim()?(localStorage.setItem(H,s.value),e.value=s.value,s.value="",t.value=!1,h.success("秘钥保存成功"),i()):h.error("请输入秘钥")},w=()=>{localStorage.removeItem(H),e.value="",h.success("秘钥重置成功")},M=()=>{e.value?w():S()},$=r=>{const _=new Date,o=new Date(r);if(isNaN(o.getTime()))return"无效的过期时间";const x=o.getTime()-_.getTime();if(x<0)return"已经过期";const V=Math.floor(x/(1e3*60*60*24)),E=Math.floor(x%(1e3*60*60*24)/(1e3*60*60)),N=Math.floor(x%(1e3*60*60)/(1e3*60));let b="";return V>0&&(b+=`${V}天`),(E>0||V>0)&&(b+=`${E}小时`),b+=`${N}分钟`,b},i=async()=>{n.value=!0;try{const r=await W("/api_key/get_information/"+e.value,"GET");if(r.is_key_valid){const o=String(r.expire_time),x=r.usage_limit,V=r.current_usage,E=x-V;if(o=="Never expire")h.success("秘钥未激活， 等待激活后显示过期时间。");else{const N=$(o),b=new Date(o.replace(" ","T")),X=Math.ceil((b.getTime()-new Date().getTime())/(1e3*60*60*24));X<=7&&h.warning(`秘钥即将过期，剩余${X}天`),h.success(`剩余有效期：${N}`)}h.info(`剩余使用积分：${E}`)}}catch(r){console.error(r),h.error("获取信息失败")}finally{n.value=!1}};return G(()=>{T()}),(r,_)=>(v(),B(z(ie),{class:"header"},{default:g(()=>[m("div",Te,[m("div",we,[e.value?(v(),L(J,{key:0},[n.value?(v(),B(z(ne),{key:0})):(v(),L("span",Me,"存储秘钥: "+A(l.value),1))],64)):Q("",!0),m("div",$e,[p(z(re),{class:"custom-button",size:"small",onClick:M},{default:g(()=>[D(A(y.value),1)]),_:1})])])]),p(z(ce),{visible:t.value,"onUpdate:visible":_[1]||(_[1]=o=>t.value=o),title:"输入新秘钥",onOk:c,onCancel:u},{default:g(()=>[p(z(le),{value:s.value,"onUpdate:value":_[0]||(_[0]=o=>s.value=o),placeholder:"请输入秘钥"},null,8,["value"])]),_:1},8,["visible"])]),_:1}))}}),Ie=Y(be,[["__scopeId","data-v-7854a61d"]]),ze={class:"content-wrapper"},De={class:"header"},Be={class:"theme-toggle-container"},Ve=["innerHTML"],Le={key:1,class:"account-list"},Ee=F({__name:"Index",setup(a){const e=ue();de();const s=f(!0),t=f(!1),n=f(`
  <p>
    1、POE账号是积分制，不存在速率限制，在该账号积分使用完毕之前均可使用，<span class="highlight">请注意您的积分消耗速度</span>，即使在有效期内，<strong>积分消耗完后也将无法使用，需要重新续费增加积分</strong>。<br><br>
    2、<span class="highlight">请注意您的秘钥有效期</span>，<strong>秘钥过期后将无法使用</strong>，续费会重置积分，不会累积。
  </p>
`),l=f([]),y=f(!1),T=()=>{t.value=!t.value},S=u=>{const c=u.idx,w=u.type;e.push({path:"/login",query:{client_idx:String(c),client_type:w}})};return P(()=>u=>u.is_session_login?"#87d068":u.type==="normal"?"#2db7f5":u.usage<10&&u.status!=="cd"?"#ffff00":"#f50"),G(async()=>{const u=async()=>{try{const i=await W("/clients_status","GET");return i&&i.length>0?(l.value=i,y.value=i.length>=10,s.value=!1,!0):!1}catch(i){return console.error("Error loading data:",i),!1}};let M=0;const $=async()=>{await u()||(M++,M<10?setTimeout($,2e3):(s.value=!1,h.error("加载数据失败，请刷新页面重试")))};$()}),(u,c)=>{const w=C("a-switch"),M=C("a-spin"),$=C("a-tag"),i=C("a-statistic"),r=C("a-card"),_=C("a-divider");return v(),L("div",{class:R(["account-pool",{"dark-theme":t.value}])},[m("div",ze,[m("div",De,[m("div",Be,[p(w,{checked:t.value,"onUpdate:checked":c[0]||(c[0]=o=>t.value=o),onChange:T},{checkedChildren:g(()=>c[1]||(c[1]=[D("🌙")])),unCheckedChildren:g(()=>c[2]||(c[2]=[D("☀️")])),_:1},8,["checked"])]),m("div",{class:R(["notice",{dark:t.value}])},[m("div",{innerHTML:n.value},null,8,Ve)],2)]),s.value?(v(),B(M,{key:0})):(v(),L("div",Le,[(v(!0),L(J,null,ve(l.value,o=>(v(),B(r,{key:o.id,hoverable:"",bordered:!1,class:R(["account-card",{dark:t.value,"card-plus":o.type==="plus","card-normal":o.type==="normal","card-cd":o.status==="cd"}]),onClick:x=>S(o)},{extra:g(()=>[p($,{color:o.type==="normal"?"#2db7f5":"#f50"},{default:g(()=>[D(A(o.type),1)]),_:2},1032,["color"])]),default:g(()=>[D(" "+A(o.id)+" ",1),p(i,{title:"该账号剩余可用积分",value:o.usage,"value-style":{color:"#3f8600"}},null,8,["value"]),p(i,{title:"状态",value:o.status==="cd"?"冷却":"可用","value-style":{color:o.status==="cd"?"#cf1322":"#3f8600"}},null,8,["value","value-style"])]),_:2},1032,["class","onClick"]))),128))])),y.value?(v(),B(_,{key:2,dashed:"",style:{"font-size":"14px","margin-top":"20px"}},{default:g(()=>c[3]||(c[3]=[D(" 上拉加载更多 ")])),_:1})):Q("",!0)])],2)}}}),Ae=Y(Ee,[["__scopeId","data-v-576be1f2"]]),Ne={style:{"margin-top":"40px"}},O="isDarkTheme",Pe=F({__name:"ClientsStatus",setup(a){const e=localStorage.getItem(O),s=f(e==="true"),t={algorithm:ke.darkAlgorithm},n=l=>{s.value=l,localStorage.setItem(O,String(l))};return(l,y)=>{const T=C("a-message-provider");return v(),B(z(ge),{theme:s.value?t:void 0},{default:g(()=>[p(T,null,{default:g(()=>[p(Ie)]),_:1}),m("div",Ne,[p(Ae,{isDarkTheme:s.value,onChangeIsDarkTheme:n},null,8,["isDarkTheme"])])]),_:1},8,["theme"])}}});export{Pe as default};
