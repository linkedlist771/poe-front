import{a6 as K,a7 as O,a8 as W,a9 as d,aa as P,ab as Z,ac as ee,ad as te,ae as F,af as se,S as ae,h as U,r as p,O as H,o as j,v,Q as D,J as f,m as _,l as L,y as $,ag as oe,x as A,F as q,I as G,p as g,R as z,ah as ne,ai as re,aj as le,ak as ce,K as k,B as J,q as ie,t as ue,N as C,w as N,n as de,al as ve}from"./index-C3_m0Zhk.js";import"//at.alicdn.com/t/c/font_4565805_mtkshfnyzag.js";const y=(a,e)=>new K(a).setAlpha(e).toRgbString(),I=(a,e)=>new K(a).lighten(e).toHexString(),fe=a=>{const e=O(a,{theme:"dark"});return{1:e[0],2:e[1],3:e[2],4:e[3],5:e[6],6:e[5],7:e[4],8:e[6],9:e[5],10:e[4]}},pe=(a,e)=>{const s=a||"#000",t=e||"#fff";return{colorBgBase:s,colorTextBase:t,colorText:y(t,.85),colorTextSecondary:y(t,.65),colorTextTertiary:y(t,.45),colorTextQuaternary:y(t,.25),colorFill:y(t,.18),colorFillSecondary:y(t,.12),colorFillTertiary:y(t,.08),colorFillQuaternary:y(t,.04),colorBgElevated:I(s,12),colorBgContainer:I(s,8),colorBgLayout:I(s,0),colorBgSpotlight:I(s,26),colorBorder:I(s,26),colorBorderSecondary:I(s,19)}},ge=(a,e)=>{const s=Object.keys(W).map(n=>{const l=O(a[n],{theme:"dark"});return new Array(10).fill(1).reduce((m,T,S)=>(m[`${n}-${S+1}`]=l[S],m),{})}).reduce((n,l)=>(n=d(d({},n),l),n),{}),t=e??P(a);return d(d(d({},t),s),Z(a,{generateColorPalettes:fe,generateNeutralColorPalettes:pe}))};function he(a){const{sizeUnit:e,sizeStep:s}=a,t=s-2;return{sizeXXL:e*(t+10),sizeXL:e*(t+6),sizeLG:e*(t+2),sizeMD:e*(t+2),sizeMS:e*(t+1),size:e*t,sizeSM:e*t,sizeXS:e*(t-1),sizeXXS:e*(t-1)}}const _e=(a,e)=>{const s=e??P(a),t=s.fontSizeSM,n=s.controlHeight-4;return d(d(d(d(d({},s),he(e??a)),ee(t)),{controlHeight:n}),te(d(d({},s),{controlHeight:n})))};function me(){const[a,e,s]=se();return{theme:a,token:e,hashId:s}}const ye={defaultConfig:F,defaultSeed:F.token,useToken:me,defaultAlgorithm:P,darkAlgorithm:ge,compactAlgorithm:_e},ke=ae,Se=ke+"/api/v1";async function xe(a,e,s,t=null,n=null){a=Se+a,t&&(a+="?"+new URLSearchParams(t).toString());try{return(await fetch(a,{method:e,headers:s,body:n?JSON.stringify(n):void 0})).json()}catch(l){console.error("Error:",l)}}async function Q(a,e,s=null,t=null){return xe(a,e,{"Content-Type":"application/json"},s,t)}const Ce={class:"header-content"},Te={class:"value-display"},we={key:1,class:"stored-value"},Me={class:"button-container"},R="SJ_API_KEY",be=U({__name:"HeaderComponent",setup(a){const e=p(""),s=p(""),t=p(!1),n=p(!1),l=H(()=>{const r=e.value;return r.length<=4?r:r.length<=8?r.slice(0,4)+"*".repeat(r.length-4):r.slice(0,4)+"****..."}),m=H(()=>e.value?"重置秘钥":"输入秘钥"),T=()=>{const r=localStorage.getItem(R);r?(e.value=r,i()):S()},S=()=>{t.value=!0},u=()=>{t.value=!1,s.value=""},c=()=>{s.value.trim()?(localStorage.setItem(R,s.value),e.value=s.value,s.value="",t.value=!1,k.success("秘钥保存成功"),i()):k.error("请输入秘钥")},w=()=>{localStorage.removeItem(R),e.value="",k.success("秘钥重置成功")},M=()=>{e.value?w():S()},b=r=>{const h=new Date,o=new Date(r);if(isNaN(o.getTime()))return"无效的过期时间";const x=o.getTime()-h.getTime();if(x<0)return"已经过期";const B=Math.floor(x/(1e3*60*60*24)),V=Math.floor(x%(1e3*60*60*24)/(1e3*60*60)),Y=Math.floor(x%(1e3*60*60)/(1e3*60));let E="";return B>0&&(E+=`${B}天`),(V>0||B>0)&&(E+=`${V}小时`),E+=`${Y}分钟`,E},i=async()=>{n.value=!0;try{const r=await Q("/api_key/get_information/"+e.value,"GET");if(r.is_key_valid){const o=String(r.expire_time);if(o=="Never expire")k.success("秘钥未激活， 等待激活后显示过期时间。");else{const x=b(o),B=new Date(o.replace(" ","T")),V=Math.ceil((B.getTime()-new Date().getTime())/(1e3*60*60*24));V<=7&&k.warning(`秘钥即将过期，剩余${V}天`),k.success(`剩余有效期：${x}`)}}}catch(r){console.error(r),k.error("获取信息失败")}finally{n.value=!1}};return j(()=>{T()}),(r,h)=>(v(),D($(ce),{class:"header"},{default:f(()=>[_("div",Ce,[_("div",Te,[e.value?(v(),L(q,{key:0},[n.value?(v(),D($(oe),{key:0})):(v(),L("span",we,"存储秘钥: "+A(l.value),1))],64)):G("",!0),_("div",Me,[g($(ne),{class:"custom-button",size:"small",onClick:M},{default:f(()=>[z(A(m.value),1)]),_:1})])])]),g($(le),{visible:t.value,"onUpdate:visible":h[1]||(h[1]=o=>t.value=o),title:"输入新秘钥",onOk:c,onCancel:u},{default:f(()=>[g($(re),{value:s.value,"onUpdate:value":h[0]||(h[0]=o=>s.value=o),placeholder:"请输入秘钥"},null,8,["value"])]),_:1},8,["visible"])]),_:1}))}}),Ie=J(be,[["__scopeId","data-v-36dfa439"]]),$e={class:"content-wrapper"},ze={class:"header"},De={class:"theme-toggle-container"},Be=["innerHTML"],Ve={key:1,class:"account-list"},Le=U({__name:"Index",setup(a){const e=ie();ue();const s=p(!0),t=p(!1),n=p(`
  <p>
    1、POE账号是积分制，不存在速率限制，在该账号积分使用完毕之前均可使用，<span class="highlight">请注意您的积分消耗速度</span>，即使在有效期内，<strong>积分消耗完后也将无法使用，需要重新续费增加积分</strong>。<br><br>
    2、<span class="highlight">请注意您的秘钥有效期</span>，<strong>秘钥过期后将无法使用</strong>，续费会重置积分，不会累积。
  </p>
`),l=p([]),m=p(!1),T=()=>{t.value=!t.value},S=u=>{const c=u.idx,w=u.type;e.push({path:"/login",query:{client_idx:String(c),client_type:w}})};return H(()=>u=>u.is_session_login?"#87d068":u.type==="normal"?"#2db7f5":u.usage<10&&u.status!=="cd"?"#ffff00":"#f50"),j(async()=>{const u=async()=>{try{const i=await Q("/clients_status","GET");return i&&i.length>0?(l.value=i,m.value=i.length>=10,s.value=!1,!0):!1}catch(i){return console.error("Error loading data:",i),!1}};let M=0;const b=async()=>{await u()||(M++,M<10?setTimeout(b,2e3):(s.value=!1,k.error("加载数据失败，请刷新页面重试")))};b()}),(u,c)=>{const w=C("a-switch"),M=C("a-spin"),b=C("a-tag"),i=C("a-statistic"),r=C("a-card"),h=C("a-divider");return v(),L("div",{class:N(["account-pool",{"dark-theme":t.value}])},[_("div",$e,[_("div",ze,[_("div",De,[g(w,{checked:t.value,"onUpdate:checked":c[0]||(c[0]=o=>t.value=o),onChange:T},{checkedChildren:f(()=>c[1]||(c[1]=[z("🌙")])),unCheckedChildren:f(()=>c[2]||(c[2]=[z("☀️")])),_:1},8,["checked"])]),_("div",{class:N(["notice",{dark:t.value}])},[_("div",{innerHTML:n.value},null,8,Be)],2)]),s.value?(v(),D(M,{key:0})):(v(),L("div",Ve,[(v(!0),L(q,null,de(l.value,o=>(v(),D(r,{key:o.id,hoverable:"",bordered:!1,class:N(["account-card",{dark:t.value,"card-plus":o.type==="plus","card-normal":o.type==="normal","card-cd":o.status==="cd"}]),onClick:x=>S(o)},{extra:f(()=>[g(b,{color:o.type==="normal"?"#2db7f5":"#f50"},{default:f(()=>[z(A(o.type),1)]),_:2},1032,["color"])]),default:f(()=>[z(" "+A(o.id)+" ",1),g(i,{title:"该账号剩余可用积分",value:o.usage,"value-style":{color:"#3f8600"}},null,8,["value"]),g(i,{title:"状态",value:o.status==="cd"?"冷却":"可用","value-style":{color:o.status==="cd"?"#cf1322":"#3f8600"}},null,8,["value","value-style"])]),_:2},1032,["class","onClick"]))),128))])),m.value?(v(),D(h,{key:2,dashed:"",style:{"font-size":"14px","margin-top":"20px"}},{default:f(()=>c[3]||(c[3]=[z(" 上拉加载更多 ")])),_:1})):G("",!0)])],2)}}}),Ee=J(Le,[["__scopeId","data-v-576be1f2"]]),Ae={style:{"margin-top":"40px"}},X="isDarkTheme",He=U({__name:"ClientsStatus",setup(a){const e=localStorage.getItem(X),s=p(e==="true"),t={algorithm:ye.darkAlgorithm},n=l=>{s.value=l,localStorage.setItem(X,String(l))};return(l,m)=>{const T=C("a-message-provider");return v(),D($(ve),{theme:s.value?t:void 0},{default:f(()=>[g(T,null,{default:f(()=>[g(Ie)]),_:1}),_("div",Ae,[g(Ee,{isDarkTheme:s.value,onChangeIsDarkTheme:n},null,8,["isDarkTheme"])])]),_:1},8,["theme"])}}});export{He as default};
