import{h as S,r as m,C as z,o as D,l as d,D as R,E as T,m as a,G as b,H as h,F as U,n as Z,I as j,p as O,J as K,K as c,L as N,N as $,v as u,y as E,x as P,B as A}from"./index-DEpiiEXZ.js";const I=["placeholder","onKeyup"],q={key:0,class:"file-preview"},G=["onClick"],J={key:0},W=["src"],Q={key:1,class:"file-icon"},X={class:"file-name"},Y={class:"button-group"},ee={class:"addFiles","aria-label":"Add attachment"},te=["disabled"],se="image/*,.pdf,.doc,.docx,.csv,.txt,.html,.htm",ae=S({__name:"SendMessageButton",props:{placeholder:{},files:{},disabled:{type:Boolean}},emits:["sendMessage","addFiles","toggleMic","updateFileList"],setup(le,{emit:L}){const l=m([]),g=window.URL||window.webkitURL,p=L;z(l,t=>{p("updateFileList",t)},{deep:!0});const M=t=>{var o;const e=(o=t.clipboardData)==null?void 0:o.items;if(e)for(let s=0;s<e.length;s++){const r=e[s];if(r.type.indexOf("image")!==-1){const v=r.getAsFile();v&&f(v,g.createObjectURL(v))}}},_=()=>{c.warning("麦克风功能暂未开放")},y=t=>{var o;const e=(o=t.dataTransfer)==null?void 0:o.files;if(e)for(let s=0;s<e.length;s++)f(e[s])},f=(t,e)=>{if(l.value.length>=5){c.error("最多只能上传5个文件");return}const o=10*1024*1024;if(t.size>o){c.error("文件大小不能超过10MB");return}l.value.push({uid:Date.now().toString(),name:t.name,status:"done",originFileObj:t,url:e})},C=t=>{if(t.size>10485760)return c.error("文件大小不能超过10MB"),!1},F=t=>{const{file:e,fileList:o}=t;e.status==="done"?c.success(`${e.name} 上传成功`):e.status==="error"&&c.error(`${e.name} file upload failed.`);const s=o.map(r=>{const{url:v,...V}=r;return V});l.value=s,p("updateFileList",s)},k=t=>{l.value.splice(t,1),p("updateFileList",l.value)},B=({onSuccess:t})=>{setTimeout(()=>{t("ok")},0)},n=m(""),i=m(null),w=()=>{n.value.trim()&&(l.value=[],p("sendMessage",n.value),n.value="",N(()=>{i.value&&(i.value.style.height="auto",x())}))},H=()=>{n.value+=`
`},x=()=>{if(i.value){i.value.style.height="auto";const t=Math.min(Math.max(i.value.scrollHeight,24),150);i.value.style.height=`${t}px`}};return D(()=>{i.value&&i.value.addEventListener("input",x)}),(t,e)=>{const o=$("a-upload");return u(),d("div",{class:"input-container",onPaste:M,onDrop:h(y,["prevent"]),onDragover:e[2]||(e[2]=h(()=>{},["prevent"]))},[R(a("textarea",{"onUpdate:modelValue":e[0]||(e[0]=s=>n.value=s),placeholder:t.placeholder,class:"chat-input",onKeyup:[b(h(w,["exact"]),["enter"]),b(h(H,["shift","exact","prevent"]),["enter"])],ref_key:"textareaRef",ref:i},null,40,I),[[T,n.value]]),l.value.length>0?(u(),d("div",q,[(u(!0),d(U,null,Z(l.value,(s,r)=>(u(),d("div",{key:r,class:"file-item"},[a("div",{class:"delete-icon",onClick:v=>k(r)},e[3]||(e[3]=[a("svg",{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",class:"delete-icon-svg"},[a("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})],-1)]),8,G),s.type&&s.type.startsWith("image")?(u(),d("div",J,[a("img",{src:s.url||E(g).createObjectURL(s.originFileObj),alt:"Preview",class:"image-preview"},null,8,W)])):(u(),d("div",Q,[e[4]||(e[4]=a("svg",{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",class:"file-icon-svg"},[a("path",{d:"M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z"})],-1)),a("span",X,P(s.name),1)]))]))),128))])):j("",!0),a("div",Y,[a("button",ee,[O(o,{"before-upload":C,accept:se,"file-list":l.value,"onUpdate:fileList":e[1]||(e[1]=s=>l.value=s),"max-count":5,customRequest:B,onChange:F,"show-upload-list":!1},{default:K(()=>e[5]||(e[5]=[a("svg",{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",class:"add-icon"},[a("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M4 12a8 8 0 1 1 16 0 8 8 0 0 1-16 0Zm8-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2Zm0 4a1 1 0 0 1 1 1v4h4a1 1 0 1 1 0 2h-4v4a1 1 0 1 1-2 0v-4H7a1 1 0 1 1 0-2h4V7a1 1 0 0 1 1-1Z"})],-1)])),_:1},8,["file-list"])]),a("button",{class:"mic-button",onClick:_,"aria-label":"Toggle microphone"},e[6]||(e[6]=[a("svg",{viewBox:"0 0 16 27",xmlns:"http://www.w3.org/2000/svg",class:"mic-icon"},[a("path",{"clip-rule":"evenodd",d:"M4.235 1.803C4.848.823 6.013 0 8 0c1.986 0 3.152.824 3.765 1.803a3.826 3.826 0 0 1 .568 1.836V3.664s0 .003-1 .003h1v10.666h-1 1v.028a1.823 1.823 0 0 1-.01.176 3.827 3.827 0 0 1-.558 1.66C11.152 17.177 9.986 18 8 18c-1.987 0-3.152-.824-3.765-1.803a3.828 3.828 0 0 1-.568-1.836V14.336s0-.003 1-.003h-1V3.667h1-1v-.028a2.004 2.004 0 0 1 .01-.176 3.827 3.827 0 0 1 .558-1.66Zm1.432 1.874.002-.036a1.828 1.828 0 0 1 .262-.778C6.152 2.51 6.653 2 8 2s1.848.51 2.069.863a1.83 1.83 0 0 1 .264.814v10.646l-.002.036a1.83 1.83 0 0 1-.262.778c-.221.353-.722.863-2.07.863-1.346 0-1.847-.51-2.068-.863a1.828 1.828 0 0 1-.264-.814V3.677Zm-4.334 4.99a1 1 0 0 1 1 1v4.666l.001.03a5.657 5.657 0 0 0 .087.725c.09.49.27 1.13.62 1.76a4.464 4.464 0 0 0 1.62 1.69c.76.457 1.827.795 3.339.795s2.579-.338 3.34-.795a4.464 4.464 0 0 0 1.62-1.69c.349-.63.528-1.27.62-1.76a5.642 5.642 0 0 0 .086-.724V9.667a1 1 0 1 1 2 0v4.666h-1 1v.035a3.958 3.958 0 0 1-.016.302 7.653 7.653 0 0 1-.104.783 7.85 7.85 0 0 1-.839 2.366 6.464 6.464 0 0 1-2.338 2.434c-.902.541-2.013.914-3.37 1.037v3.377h4.334a1 1 0 0 1 0 2H2.667a1 1 0 1 1 0-2H7v-3.378c-1.356-.122-2.467-.495-3.369-1.036a6.463 6.463 0 0 1-2.339-2.434 7.852 7.852 0 0 1-.838-2.366 7.66 7.66 0 0 1-.118-1.015 3.637 3.637 0 0 1-.002-.07v-.032s0-.003 1-.003h-1V9.667a1 1 0 0 1 1-1Z"})],-1)])),a("button",{class:"send-button",onClick:w,disabled:t.disabled||!n.value.trim(),"aria-label":"Send message"},e[7]||(e[7]=[a("svg",{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",class:"send-icon"},[a("path",{d:"M4 13h14.09l-6.79 6.79a.996.996 0 1 0 1.41 1.41l8.5-8.5c.06-.06.09-.13.13-.2.03-.04.06-.08.08-.13a.91.91 0 0 0 .08-.37c0-.03-.01-.05-.01-.07-.01-.1-.02-.21-.06-.31a.955.955 0 0 0-.22-.33L12.72 2.8c-.2-.2-.45-.29-.71-.29-.26 0-.51.1-.71.29a.996.996 0 0 0 0 1.41L18.08 11H4c-.55 0-1 .45-1 1s.45 1 1 1Z"})],-1)]),8,te)])],32)}}}),ie=A(ae,[["__scopeId","data-v-f504b997"]]);export{ie as S};
